<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.3.9: http://docutils.sourceforge.net/" />
<title>Permanent Data Storage (Flash)</title>
<meta name="author" content="David Gay, Jonathan Hui" />
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:date: $Date: 2006-05-18 23:07:25 $
:version: $Revision: 1.1.2.1 $
:copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.
*/
body {
  font-family: Times;
  font-size: 16px;
}

.first {
  margin-top: 0 ! important }

.last {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dd {
  margin-bottom: 0.5em }

/* Uncomment (& remove this text!) to get bold-faced definition list terms
dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.attention, div.caution, div.danger, div.error, div.hint,
div.important, div.note, div.tip, div.warning, div.admonition {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

div.hint p.admonition-title, div.important p.admonition-title,
div.note p.admonition-title, div.tip p.admonition-title,
div.admonition p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em }

div.footer, div.header {
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 0em 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1 {
  font-family: Arial, sans-serif;
  font-size: 20px;
}

h1.title {
 text-align: center;
 font-size: 32px;
}

h2 {
 font-size: 16px;
 font-family: Arial, sans-serif;
}

h2.subtitle {
  text-align: center }

h3 {
 font-size: 12px;
 font-family: Arial, sans-serif;
}

hr {
  width: 75% }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.line-block {
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.option-argument {
  font-style: italic }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

table {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.citation {
  border-left: solid thin gray ;
  padding-left: 0.5ex }

table.docinfo {
  margin: 2em 4em;
}

table.footnote {
  border-left: solid thin black ;
  padding-left: 0.5ex }

td, th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

th.docinfo-name, th.field-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap;
  }

h1 tt, h2 tt, h3 tt, h4 tt, h5 tt, h6 tt {
  font-size: 100% }

tt {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="permanent-data-storage-flash">
<h1 class="title">Permanent Data Storage (Flash)</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">TEP:</th><td class="field-body">103</td>
</tr>
<tr class="field"><th class="docinfo-name">Group:</th><td class="field-body">Core Working Group</td>
</tr>
<tr class="field"><th class="docinfo-name">Type:</th><td class="field-body">Documentary</td>
</tr>
<tr><th class="docinfo-name">Status:</th>
<td>Draft</td></tr>
<tr class="field"><th class="docinfo-name">TinyOS-Version:</th><td class="field-body">2.x</td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>David Gay, Jonathan Hui</td></tr>
<tr class="field"><th class="docinfo-name">Draft-Created:</th><td class="field-body">27-Sep-2004</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Version:</th><td class="field-body">1.1.2.2</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Modified:</th><td class="field-body">2006-02-14</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Discuss:</th><td class="field-body">TinyOS Developer List &lt;tinyos-devel at mail.millennium.berkeley.edu&gt;</td>
</tr>
</tbody>
</table>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">This memo documents a part of TinyOS for the TinyOS Community, and
requests discussion and suggestions for improvements.  Distribution
of this memo is unlimited. This memo is in full compliance with
TEP 1.</p>
</div>
<div class="section" id="abstract">
<h1><a name="abstract">Abstract</a></h1>
<p>This memo documents a set of hardware-independent, non-volatile
storage interfaces for TinyOS 2.x, and the HPL and HAL layers for
various flash chips.</p>
</div>
<div class="section" id="introduction">
<h1><a name="introduction">1. Introduction</a></h1>
<p>There are three different flash chip families under use or
consideration for TinyOS platforms: the Atmel AT45DB family (Mica
family, Telos rev. A), the ST M25P family (Telos rev. B, eyes) and the
Intel Strataflash (imote2).  All three are &quot;NOR&quot; flash chips, but the
AT45DB has fairly different characteristics (see below). There also
&quot;NAND&quot; flash chips which have rather different tradeoffs from NOR
flash. Compact flash/etc cards use NAND flash but present a disk-like
block interface.</p>
<p>A common restriction of flash technology is that each bit can only be
written once between erases. The table below summarizes the
differences between the various flash technologies:</p>
<pre class="literal-block">
                 NOR                AT45DB         NAND

Erase        :  Slow (seconds)      Fast (ms)      Fast (ms)
Erase unit   :  Large (64KB-128KB)  Small (256B)   Medium (8K-32KB)
Writes       :  Slow (100s kB/s)    Slow (60kB/s)  Fast (MBs/s)
Write unit   :  1 bit               256B           100's of bytes
Bit-errors   :  Low                 Low            High (requires ECC, 
                                                   bad-block mapping)
Read         :  Fast*               Slow+I/O bus   Fast (but limited by 
                                                   I/O bus)
Erase cycles :  10^4 - 10^5         10^4 **        10^5 - 10^7
Intended use :  Code storage        Data storage   Data storage

*  imote2 NOR flash is memory mapped (reads are very fast and can
   directly execute code)
** Or infinite? Data sheet just says that every page within a sector
   must be written every 10^4 writes within that sector
</pre>
<p>From the power consumption for erasing and writing, we can derive an
energy cost/byte written (for NAND flash, taken from a Samsung
datasheet):</p>
<blockquote>
Energy/byte:    1uJ                 1uJ            .01uJ</blockquote>
<p>Energy/byte for reads appears to depend mostly on how long the read
takes (the power consumptions are comparable), i.e., on the efficiency
of the bus + processor.</p>
</div>
<div class="section" id="non-volatile-storage-abstraction-in-tinyos-2-x">
<h1><a name="non-volatile-storage-abstraction-in-tinyos-2-x">2. Non-Volatile Storage Abstraction in TinyOS 2.x</a></h1>
<p>The very significant differences between the flash chips used in
TinyOS preclude common, low-level HIL interfaces such as a disk-like
block interface. Instead, we propose that the HIL interfaces
correspond to high-level storage services useful for sensor network
applications. We have identified three storage abstractions: large
object, small objects, and logs. We envision separate implementations
of these abstractions for each class of storage chip; these
implementations will be found in the new tos/chips/CHIPNAME hierarchy.</p>
<div class="section" id="large-objects">
<h2><a name="large-objects">2.1 Large objects:</a></h2>
<p>This scenario involves getting a large (100's bytes to kilobytes or
more) free chunk (through alloc or erase), writing to each byte/block
once in any arbitrary order, and &quot;committing&quot; when the chunk is
filled.</p>
<blockquote>
Size: large
Reads: random
Writes: random (minimum block size?), each block written once
Failure model: no fault tolerance (crash before commit leads to
object loss)
Other: a commit operation terminates writes, a validate operation
checks the object.</blockquote>
</div>
<div class="section" id="large-sequential-objects-logs">
<h2><a name="large-sequential-objects-logs">2.2 Large sequential objects (Logs)</a></h2>
<p>Some applications (e.g., low-rate data collection) may want to log all
their results in a reliable fashion, possibly in a circular buffer.</p>
<blockquote>
<p>Size: large
Reads: from memorized write points or beginning
Writes: sequential, object is linear or circular</p>
<p>Failure model: writes are atomic, failure during/between writes does
not lead to whole object loss, but may lead to loss of some entries
(but see sync)
Note: failure during write may lead to (minor) capacity reduction
Other: sync: guarantees already written data will not be lost to
(crash-style) failure</p>
</blockquote>
</div>
<div class="section" id="small-objects">
<h2><a name="small-objects">2.3 Small objects:</a></h2>
<p>This scenario involves keeping a small chunk (less than 100 some
bytes). Requires multiple and random reads/writes.</p>
<blockquote>
Size: small
Reads: random
Writes: random, no minimum block size, rewrite ok
Failure model: writes are atomic, failure during/between writes
does not lead to object loss</blockquote>
</div>
</div>
<div class="section" id="hpl-hal-hil-architecture">
<h1><a name="hpl-hal-hil-architecture">3. HPL/HAL/HIL Architecture</a></h1>
<p>The proposed architecture aligns with the three-layer Hardware
Abstraction Architecture (HAA).</p>
<div class="section" id="hardware-presentation-layer-hpl">
<h2><a name="hardware-presentation-layer-hpl">3.1 Hardware Presentation Layer (HPL)</a></h2>
<ol class="loweralpha">
<li><p class="first">Implementation: system dependent</p>
</li>
<li><p class="first">Presentation: chip (family?) dependent (common HPL for same chip
(family?) on different systems)</p>
</li>
<li><p class="first">Stateless</p>
</li>
<li><p class="first">Atmel 45DB family low-level interfaces</p>
<p>select, send/receive SPI byte, idle detection
(no commands, as efficiency dictates their integration in the HAL)
See tos/platform/mica/HPLFlashM</p>
</li>
<li><p class="first">Intel Strataflash</p>
<p>write data, erase, lock/unlock blocks, read config data, etc.
details omitted - main interesting point is lack of reads, as
device is memory mapped</p>
</li>
<li><p class="first">M25P family</p>
<p>r/w data, erase (sector or chip), r/w status, etc
(full details omitted)</p>
</li>
</ol>
</div>
<div class="section" id="hardware-adaptation-layer-hal">
<h2><a name="hardware-adaptation-layer-hal">3.2 Hardware Adaptation Layer (HAL)</a></h2>
<ol class="loweralpha">
<li><p class="first">Implementation: chip dependent</p>
</li>
<li><p class="first">Presentation: chip dependent</p>
</li>
<li><p class="first">Atmel AT45DB:</p>
<p>interface {</p>
<blockquote>
<dl class="docutils">
<dt>command void write(at45page_t page, at45pageoffset_t offset,</dt>
<dd><p class="first">void <a href="#id1" name="id2"><span class="problematic" id="id2">*</span></a>PASS data, at45pageoffset_t n);</p>
<div class="last system-message" id="id1">
<p class="system-message-title">System Message: <a name="id1">WARNING/2</a> (<tt class="docutils">txt/tep103.txt</tt>, line 175); <em><a href="#id2">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 176)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>event void writeDone(error_t error);</p>
<p>command void erase(at45page_t page, uint8_t eraseKind);
event void eraseDone(error_t error);</p>
<p>command void sync(at45page_t page);
command void syncAll();</p>
<p>event void syncDone(error_t error);</p>
<p>command void flush(at45page_t page);
command void flushAll();
event void flushDone(error_t error);</p>
<dl class="docutils">
<dt>command void read(at45page_t page, at45pageoffset_t offset,</dt>
<dd><p class="first">void <a href="#id3" name="id4"><span class="problematic" id="id4">*</span></a>PASS data, at45pageoffset_t n);</p>
<div class="last system-message" id="id3">
<p class="system-message-title">System Message: <a name="id3">WARNING/2</a> (<tt class="docutils">txt/tep103.txt</tt>, line 191); <em><a href="#id4">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 192)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>event void readDone(error_t error);</p>
<dl class="docutils">
<dt>command void computeCrc(at45page_t page, at45pageoffset_t offset,</dt>
<dd><p class="first last">at45pageoffset_t n, uint16_t baseCrc);</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 196)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>event void computeCrcDone(error_t error, uint16_t crc);</p>
</blockquote>
<p>}</p>
</li>
<li><p class="first">Intel Strataflash (should extend to other memory-mapped NOR flashes):</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 202)</p>
<p>Literal block expected; none found.</p>
</div>
<p>interface { /* In flux until higher level stuff written <a href="#id5" name="id6"><span class="problematic" id="id6">*</span></a>/</p>
<div class="system-message" id="id5">
<p class="system-message-title">System Message: <a name="id5">WARNING/2</a> (<tt class="docutils">txt/tep103.txt</tt>, line 202); <em><a href="#id6">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</div>
<blockquote>
<p>command error_t lockRange(storage_addr_t_t from, storage_len_t count);
command error_t unlockRange(storage_addr_t from, storage_len_t count);</p>
<p>/* These return to read array mode when done <em>/
command error_t write(storage_addr_t addr, void</em> buf, storage_len_t len);
event   void    writeDone(storage_addr_t addr, void* buf,</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">txt/tep103.txt</tt>, line 210)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<p>storage_len_t len, error_t error);</p>
</blockquote>
<p>command error_t erase(storage_addr_t block);
event   void    eraseDone(storage_addr_t block, error_t success);</p>
</blockquote>
<p>}</p>
</li>
<li><p class="first">STMicroelectronics M25P:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 219)</p>
<p>Literal block expected; none found.</p>
</div>
<dl class="docutils">
<dt>interface {</dt>
<dd><p class="first">command error_t read(stm25p_addr_t addr, void* buf, stm25p_addr_t len);
event   error_t readDone(stm25p_addr_t addr, void* buf, stm25p_addr_t len,</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">txt/tep103.txt</tt>, line 222)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<p>error_tresult);</p>
</blockquote>
<dl class="docutils">
<dt>command error_t write(stm25p_addr_t addr, void* buf, </dt>
<dd><p class="first last">stm25p_addr_t len);</p>
</dd>
<dt>event   error_t writeDone(stm25p_addr_t addr, void* buf, </dt>
<dd><p class="first last">stm25p_addr_t len, error_t error);</p>
</dd>
</dl>
<p>command error_t erase(uint8_t sector, uint8_t num_sectors);
event   error_t eraseDone(uint8_t sector, uint8_t num_sectors,</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">txt/tep103.txt</tt>, line 231)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<p>error_t error);</p>
</blockquote>
<dl class="last docutils">
<dt>command error_t computeCrc(uint16_t crc, stm25p_addr_t addr, </dt>
<dd><p class="first last">stm25p_len_t len );</p>
</dd>
<dt>event void computeCrcDone(stm25p_addr_t addr, stm25p_len_t len, </dt>
<dd><p class="first last">uint16_t crc, error_t error);</p>
</dd>
</dl>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 237)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
</li>
</ol>
</div>
<div class="section" id="hardware-interface-layer-hil">
<h2><a name="hardware-interface-layer-hil">3.3 Hardware Interface Layer (HIL)</a></h2>
<ol class="loweralpha">
<li><p class="first">Implementation: Chip dependent</p>
</li>
<li><p class="first">Presentation: application-level OS service (see discussion above)</p>
</li>
<li><p class="first">Space allocation</p>
<p>The volume table MUST be specified by an xml file that is placed in
the application's directory (where one types 'make'). The xml file
specifies the allocation as follows:</p>
<dl class="docutils">
<dt>&lt;volume_table&gt;</dt>
<dd><p class="first last">&lt;volume name=&quot;DELUGE0&quot; size=&quot;65536&quot; /&gt;
&lt;volume name=&quot;CONFIGLOG&quot; size=&quot;65536&quot; /&gt;
&lt;volume name=&quot;DATALOG&quot; size=&quot;131072&quot; /&gt;
&lt;volume name=&quot;GOLDENIMAGE&quot; size=&quot;65536&quot; base=&quot;983040&quot; /&gt;</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 256)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>&lt;/volume_table&gt;</p>
<p>The name and size parameters are required, while base is
optional. The name is a string containing one or more characters in
[<a href="#id7" name="id8"><span class="problematic" id="id8">a-zA-Z0-9_</span></a>], while size and base are in bytes. Each storage chip
MUST provide a compile-time tool that translates the allocation
specification to chip-specific nesc code. There is no constraint on
how this is done or what code is produced, except that the
specification to physical allocation MUST be one-to-one (i.e. a
given specification should always have the same resulting physical
allocation on a given chip) and the result MUST be placed in the
build directory. When not specified, the tool may give any suitable
physical location to a volume. If there is any reason that the
physical allocation cannot be satisfied, an error should be given
at compile time.</p>
<p>The compile-time tool MUST prepend '<a href="#id9" name="id10"><span class="problematic" id="id10">VOLUME_</span></a>' to each volume name in
the xml file and '#define' each resulting name to map to a unique
integer. To use the volume, the client passes the macro to the
generic component as follows:</p>
<p>components new BlockStorage( VOLUME_DELUGE0 );</p>
<p>If the named volume is not in the specification, nesc will give a
compile-time error since the string will be undefined.</p>
</li>
<li><p class="first">Large objects:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 284)</p>
<p>Literal block expected; none found.</p>
</div>
<dl class="docutils">
<dt>interface BlockWrite {</dt>
<dd><dl class="first docutils">
<dt>command error_t write(storage_addr_t addr, void* buf, </dt>
<dd><p class="first last">storage_len_t len);</p>
</dd>
<dt>event void writeDone(storage_addr_t addr, void* buf, </dt>
<dd><p class="first last">storage_len_t len, error_t error);</p>
</dd>
</dl>
<p>command error_t erase();
event   void    eraseDone(error_t result);</p>
<dl class="last docutils">
<dt>command error_t commit();</dt>
<dd><p class="first last">event  void    commitDone(error_t result);</p>
</dd>
</dl>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 295)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
<dl class="docutils">
<dt>interface BlockRead {</dt>
<dd><p class="first">command error_t read(addr_t addr, void* dest, addr_t len);
event   void    readDone(storage_error_t result);</p>
<p>command error_t verify();
event   void    verifyDone(storage_error_t result);</p>
<p>command error_t computeCrc(storage_addr_t addr, storage_len_t len );
event   void    computeCrcDone(storage_addr_t addr, storage_len_t len,</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">txt/tep103.txt</tt>, line 306)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote class="last">
<p>uint16_t crc, error_t error );</p>
</blockquote>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 307)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
</li>
<li><p class="first">Large sequential objects:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 311)</p>
<p>Literal block expected; none found.</p>
</div>
<dl class="docutils">
<dt>interface LogWrite {</dt>
<dd><p class="first">command error_t erase();
event   void    eraseDone(storage_error_t success);</p>
<p>command error_t append(void* buf, storage_len_t len);
event   void    appendDone(void* buf, storage_len_t len, error_t error);</p>
<p>command storage_cookie_t currentOffset();</p>
<p class="last">command error_t sync();
event   void    syncDone(storage_error_t success);</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 322)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
<dl class="docutils">
<dt>interface LogRead {</dt>
<dd><p class="first">command error_t read(void* buf, storage_len_t len);
event   void    readDone(void* buf, stroage_len_t len, error_t error);</p>
<p>command storage_cookie_t currentOffset();</p>
<p class="last">command error_t seek(stroage_cookie_t cookie);
event   void    seekDone(error_t error);</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 332)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
<p>The circular-vs-linear distinction is made by offering separate
instances of the LogData, LogRead interfaces.</p>
</li>
<li><p class="first">Small objects:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 339)</p>
<p>Literal block expected; none found.</p>
</div>
<dl class="docutils">
<dt>interface ConfigStorage {</dt>
<dd><p class="first">command error_t read(addr_t addr, void* dest, addr_t len);
event   void    readDone(storage_error_t result);</p>
<p>command error_t write(addr_t addr void* source, addr_t len);
event   void    writeDone(storage_error_t result);</p>
<p class="last">command error_t commit();
event   void    commitDone(storage_error_t result);</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">txt/tep103.txt</tt>, line 348)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</div>
<p>}</p>
</li>
</ol>
</div>
</div>
<div class="section" id="implementation">
<h1><a name="implementation">4. Implementation</a></h1>
<p>An AT45DB implementation can be found in tinyos-2.x/tos/chips/at45db.
An STM25P implementation can be found in tinyos-2.x/tos/chips/stm25p.</p>
</div>
<div class="section" id="author-s-address">
<h1><a name="author-s-address">5. Author's Address</a></h1>
<div class="line-block">
<div class="line">David Gay</div>
<div class="line">2150 Shattuck Ave, Suite 1300</div>
<div class="line">Intel Research</div>
<div class="line">Berkeley, CA 94704</div>
<div class="line"><br /></div>
<div class="line">phone - +1 510 495 3055</div>
<div class="line">email - <a class="reference" href="mailto:david.e.gay&#64;intel.com">david.e.gay&#64;intel.com</a></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line">Jonathan Hui</div>
<div class="line">657 Mission St. Ste. 600</div>
<div class="line">Arched Rock Corporation</div>
<div class="line">San Francisco, CA 94105-4120</div>
<div class="line"><br /></div>
<div class="line">phone - +1 415 692 0828</div>
<div class="line">email - <a class="reference" href="mailto:jhui&#64;archedrock.com">jhui&#64;archedrock.com</a></div>
</div>
</div>
<div class="system-messages section">
<h1><a>Docutils System Messages</a></h1>
<div class="system-message" id="id7">
<p class="system-message-title">System Message: <a name="id7">ERROR/3</a> (<tt class="docutils">txt/tep103.txt</tt>, line 258); <em><a href="#id8">backlink</a></em></p>
Unknown target name: &quot;a-za-z0-9&quot;.</div>
<div class="system-message" id="id9">
<p class="system-message-title">System Message: <a name="id9">ERROR/3</a> (<tt class="docutils">txt/tep103.txt</tt>, line 272); <em><a href="#id10">backlink</a></em></p>
Unknown target name: &quot;volume&quot;.</div>
</div>
</div>
</body>
</html>
